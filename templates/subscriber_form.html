{% extends "base.html" %}

{% block title %}{% if mode == 'edit' %}구독자 수정{% else %}구독자 추가{% endif %} | KCA 뉴스레터{% endblock %}

{% block content %}
<div class="grid md:grid-cols-2 gap-6">
  <!-- 왼쪽 컬럼: 구독자 정보 폼 -->
  <div>
    <div class="card">
      <div class="card-header flex items-center justify-between pb-2">
        <div>
          <h2 class="card-title">{% if mode == 'edit' %}구독자 수정{% else %}구독자 추가{% endif %}</h2>
          <p class="card-description">{% if mode == 'edit' %}기존 구독자 정보 수정{% else %}새로운 구독자 등록{% endif %}</p>
        </div>
        <a href="{{ url_for('list_subscribers') }}" class="btn btn-ghost">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 h-4 w-4">
            <path d="m12 19-7-7 7-7"></path>
            <path d="M19 12H5"></path>
          </svg>
          목록으로
        </a>
      </div>
      <div class="card-content">
        {% if mode == 'edit' %}
        <div class="flex items-center gap-4 mb-6">
          <div class="w-16 h-16 rounded-full bg-primary/10 text-primary flex items-center justify-center text-2xl font-semibold">
            {{ subscriber.name[0] }}
          </div>
          <div>
            <h3 class="text-lg font-medium">{{ subscriber.name }}</h3>
            <p class="text-sm text-muted-foreground">{{ subscriber.email }}</p>
          </div>
        </div>
        {% endif %}
        
        <form method="post" action="{% if mode == 'edit' %}{{ url_for('edit_subscriber', subscriber_id=subscriber.id) }}{% else %}{{ url_for('add_subscriber') }}{% endif %}" class="space-y-6">
          <input type="hidden" name="csrf_token" value="{{ csrf_token }}"/>
          
          <div class="space-y-2">
            <label for="name" class="text-sm font-medium">이름</label>
            <div class="relative">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 absolute left-3 top-3 text-muted-foreground">
                <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
              </svg>
              <input type="text" id="name" name="name" class="input pl-10 w-full min-h-[50px]" placeholder="구독자 이름" value="{% if mode == 'edit' %}{{ subscriber.name }}{% endif %}" required>
            </div>
          </div>
          
          <div class="space-y-2">
            <label for="email" class="text-sm font-medium">이메일</label>
            <div class="relative">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 absolute left-3 top-3 text-muted-foreground">
                <rect width="20" height="16" x="2" y="4" rx="2"></rect>
                <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
              </svg>
              <input type="email" id="email" name="email" class="input pl-10 w-full min-h-[50px]" placeholder="example@email.com" value="{% if mode == 'edit' %}{{ subscriber.email }}{% endif %}" required>
            </div>
          </div>
          
          <div class="space-y-2">
            <label for="topics" class="text-sm font-medium">관심 토픽</label>
            <div class="relative">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5 absolute left-3 top-3 text-muted-foreground">
                <path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path>
              </svg>
              <textarea id="topics" name="topics" class="input pl-10 w-full min-h-[100px]" placeholder="관심 토픽을 쉼표(,)로 구분하여 입력하세요">{% if mode == 'edit' %}{{ subscriber.topics|join(', ') }}{% endif %}</textarea>
            </div>
            <p class="text-xs text-muted-foreground">예: AI, 빅데이터, 클라우드 (쉼표로 구분)</p>
          </div>
          
          {% if mode == 'edit' %}
          <div class="flex gap-3">
            <button type="submit" class="btn btn-primary flex-1">구독자 정보 수정</button>
            <a href="{{ url_for('delete_subscriber', subscriber_id=subscriber.id) }}" 
              onclick="return confirm('정말로 이 구독자를 삭제하시겠습니까?');" 
              class="btn btn-danger">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4">
                <path d="M3 6h18"></path>
                <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
              </svg>
            </a>
          </div>
          {% else %}
          <button type="submit" class="btn btn-primary w-full">구독자 추가</button>
          {% endif %}
        </form>
      </div>
    </div>
  </div>
  
  <!-- 오른쪽 컬럼: 토픽 관리 및 도움말 -->
  <div>
    <div class="card mb-6">
      <div class="card-header pb-2">
        <h2 class="card-title">토픽 관리 가이드</h2>
        <p class="card-description">효과적인 토픽 관리 방법</p>
      </div>
      <div class="card-content">
        <div class="bg-muted rounded-md p-4 mb-4">
          <h3 class="text-sm font-medium mb-2">토픽 작성 요령</h3>
          <ul class="space-y-2 text-sm">
            <li class="flex items-start gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4 mt-0.5 shrink-0 text-green-600">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
              <span>간결하고 명확한 키워드 사용 (예: AI, 클라우드)</span>
            </li>
            <li class="flex items-start gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4 mt-0.5 shrink-0 text-green-600">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
              <span>산업 표준 용어 활용</span>
            </li>
            <li class="flex items-start gap-2">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4 mt-0.5 shrink-0 text-red-600">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
              <span>너무 광범위하거나 모호한 용어 지양</span>
            </li>
          </ul>
        </div>
        
        <h3 class="text-sm font-medium mb-2">토픽 예시</h3>
        <div class="flex flex-wrap gap-2 mb-6">
          <div class="badge bg-secondary text-secondary-foreground">인공지능</div>
          <div class="badge bg-secondary text-secondary-foreground">빅데이터</div>
          <div class="badge bg-secondary text-secondary-foreground">클라우드</div>
          <div class="badge bg-secondary text-secondary-foreground">블록체인</div>
          <div class="badge bg-secondary text-secondary-foreground">사이버보안</div>
          <div class="badge bg-secondary text-secondary-foreground">IoT</div>
          <div class="badge bg-secondary text-secondary-foreground">자율주행</div>
          <div class="badge bg-secondary text-secondary-foreground">메타버스</div>
          <div class="badge bg-secondary text-secondary-foreground">디지털전환</div>
        </div>
        
        <div class="bg-primary/10 rounded-md p-4">
          <h3 class="text-sm font-medium mb-2">AI 토픽 추천</h3>
          <p class="text-sm">뉴스레터 시스템은 AI를 활용하여 구독자의 관심사에 맞는 토픽을 추천합니다.</p>
          <a href="#" class="text-sm font-medium text-primary inline-flex items-center mt-2">
            <span>자세히 알아보기</span>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-1 h-3 w-3">
              <path d="M5 12h14"></path>
              <path d="m12 5 7 7-7 7"></path>
            </svg>
          </a>
        </div>
      </div>
    </div>
    
    {% if mode == 'edit' %}
    <div class="card">
      <div class="card-header pb-2">
        <h2 class="card-title">현재 토픽 관리</h2>
        <p class="card-description">현재 구독 중인 토픽</p>
      </div>
      <div class="card-content">
        <div class="flex flex-wrap gap-2 mb-4">
          {% for topic in subscriber.topics %}
          <div class="badge bg-primary text-primary-foreground">{{ topic }}</div>
          {% endfor %}
        </div>
        
        <div class="p-4 bg-muted rounded-md">
          <div class="flex items-start gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-6 w-6 mt-0.5 text-blue-600 shrink-0">
              <circle cx="12" cy="12" r="10"></circle>
              <path d="M12 16v-4"></path>
              <path d="M12 8h.01"></path>
            </svg>
            <div>
              <h4 class="text-sm font-medium mb-1">구독자 활동 정보</h4>
              <p class="text-xs text-muted-foreground">이 구독자는 지금까지 <strong>{{ subscriber.topics|length }}</strong>개의 토픽을 구독하고 있습니다.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %} 